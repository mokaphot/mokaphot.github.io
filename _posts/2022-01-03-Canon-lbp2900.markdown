---
layout: post
title: "پرینتر Canon-LBP2900"
date: 2022-01-03 11:19:17 +0330
excerpt_separator: <!--more-->
categories:
 - linux
tags:
- linux
- canon
- lbp2900
- printer
- driver
- cups
- capt
- port
- service
- daemon
- captstatusui
- print
- pause
- resume
- لینوکس
- کنون
- پرینتر
- درایور
- پورت
- دیمن
- پرینت
---
این روز‌ها نصب و راه اندازی پرینتر مخصوصا در ویندوز کار ساده‌ایست و براحتی به کمک سی دی همراه پرینتر کارتان راه می‌افتد. با پرینترهای جدید در لینوکس هم مشکلی نخواهید داشت  و معمولا بلافاصله بعد از اتصال پرینتر به سیستم و روشن شدنش، بصورت خودکار شناسایی و نصب میشود.  
ولی اگر مثل من پرینترتان قدیمی باشد و بخواهید در آرچ لینوکس آن را نصب کنید به مشکل بر میخورید و باید آن را دستی نصب کنید /:    
<!--more-->
#### نصب درایور
در ابتدا باید مخزن `mutilib` را در فایل `/etc/pacman.conf` فعال کنید و سپس با دستور زیر درایور `capt` را نصب کنید:  
```console
$ yay -S capt-src
```  
درایور `capt` اصطلاحا روی درایور `CUPS` مینشیند، بنابراین باید آن هم نصب شود:  
```console
$ sudo pacman -S cups
```  
سپس `CUPS` را فعال میکنیم:   
```console
$ systemctl enable cups.service
$ systemctl start cups.service
```  
و وضعیتش را بدین صورت چک میکنیم:  
```console
$ systemctl status cups.service
```  
باید آن را `active` نشان دهد.  
#### تنظیمات CAPT
ابتدا اگر کاربر عضو گروه‌ `lp` نیست آن را با بدین صورت اضافه میکنیم به این گروه‌:  
```console
$ sudo gpasswd -a <username> lp
```  
به آدرس `/usr/share/cups/model/` میرویم و از آن لیست میگیریم. باید فایل `CNCUPSLBP2900CAPTK.ppd` وجود داشته باشد سپس دستور زیر را اجرا میکنیم  
```console
$ sudo /usr/sbin/lpadmin -p LBP2900 -m CNCUPSLBP2900CAPTK.ppd -v ccp://localhost:59687 -E
```  
حالا پرینتر را روشن میکنیم و بررسی میکنیم آیا پرینتر بدرستی متصل شده به سیستم و به کدام پورت وصل است:  
```console
$ ls -l /dev/usb
```  
خروجی آن اگر پرینتر را بدرستی وصل کرده باشید و روشن باشد چیزی شبیه به این است  
```console
crw-rw---- 1 root lp 180, 0 Jan  3 12:06 lp0
```  
که این یعنی پرینتر به پورت `lp0` وصل است. با دستور زیر، کار نصب درایور را ادامه میدهیم:  
```console
$ sudo /usr/sbin/ccpdadmin -p LBP2900 -o /dev/usb/lp0
```  
پورت استفاده شده در دستور بالا را بر حسب شرایط خودتان تغییر دهید من در اینجا از پورت `lp0` استفاده کرده‌ام.   
نصب را با دستورات زیر ادامه میدهیم:  
```console
$ sudo systemctl enable ccpd.service
```  
کامپیوتر را از نو راه‌اندازی میکنیم و پرینتر را نیز یکبار خاموش و روشن میکنیم.  
کار نصب تمام شد و فقط باید ببینیم همه چیز درست پیش میرود:
```console
$ captstatusui -P LBP2900
```  
اگر خروجی زیر را داد باید بسته `libxml2` را نصب کنید و سیستم را دوباره راه‌اندازی کنید..  
```console
<Printer ***> of /etc/ccpd.conf
```  
اگر `captstatusui` نشان داد که پرینتر آماده بکار است ولی پرینت نمیگیرد باید چک کنید پرینتر در حالت `pause` قرار دارد یا نه:  
به صفحه CUPS میرویم به آدرس:
```
http://localhost:631
```  
به سربرگ `Printers` رفته و اگر پرینتر در حالت `pause` بود `resume printer` را میزنیم  
حالا باید پرینتر نصب و آماده استفاده باشد اگر باز هم پرینت نمیگیرد یک بار دیگر آن را خاموش و سپس روشن کنید
